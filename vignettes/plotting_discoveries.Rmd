---
title: "Plotting species discovery"
output: rmarkdown::html_vignette
resource_files:
    - cumulative_discovery_Crotalaria.png
vignette: >
  %\VignetteIndexEntry{Plotting species discovery}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{css, echo=FALSE}
p.caption {
  font-size: 0.8em;
}
.table{
  width: auto;
  font-size: 14px;
}
.table caption {
  font-size: 1em;
}
```

Here in this article, we show how to use the package's `accGraph` function
for plotting the species discovery over time. This function can create two types of graphs: species accumulation curves recording the cumulative number of species discovery in each genus as a function of the year of the protologue, and a violin graph to visualize and compare the discovery density of each genera within the provided dataset. The species discovery curve will necessarily represent a continuous growth and its rate of increase will be related to the quantity of new discoveries, while the violin plot will be a way to visualize distribution around the median, the mean and the minimum and maximum of the data. The latter is a way for comparing variations in the data and it fits to multimodal distributions (e.g., more than one peak representing years with many publications). To use this function, the data must be stored in a spreadsheet/dataset generated using `powoSpecies` function with the argument `synonyms` set to TRUE. The graphs will be colored according to the need of year rectification using [Viridis](https://CRAN.R-project.org/package=viridis) color palettes.\

\

## Setup

Install the latest development version of __expowo__ from 
[GitHub](https://github.com/):

``` r
#install.packages("devtools")
devtools::install_github("DBOSlab/expowo")
```
```{r package load, message=FALSE, warning=FALSE}
library(expowo)
```

\

## 1. Plotting the accumulation of species discoveries for one genus
The example below shows the accumulation curve for _Crotalaria_, one big legume genus.
Different file formats (e.g. JPG, PDF, PNG, TIFF) are also supported by setting 
the argument `format`.\ 

```{r, eval = FALSE}
accGraph(inputdf = "Crotalaria_spp",
         verbose = TRUE,
         multi = FALSE,
         save = TRUE,
         dir = "results_accGraph",
         filename = "cumulative_discovery_Crotalaria",
         format = "jpg")
```

\
```{r, echo = FALSE, out.width = "600px", fig.cap = "FIGURE 1. Accumulation graph of new species discoveries in the big genus _Crotalaria_ over time."}
knitr::include_graphics("figures/cumulative_discovery_Crotalaria.png", 
                        dpi = 300)
```

\

The accumulation curve of _Crotalaria_ shows that it has 712 spp. and a high increase of taxonomic changes between 1840 and 1920 (noticeable by the curve in light red).

## 2. Plotting the accumulation of species discoveries for the entire dataset
If your dataset contains species from more than one genus, the `accGraph` function will
automatically plot a violin graph comparing new discoveries within those genera. In the example before, we adjusted the argument `multi` to FALSE, but notice that it is set as TRUE (default) in the example below. To get those graphs, we extracted
all data of the genera _Andropogon_, _Olyra_ and _Digitaria_ from Plants of the World Online using `powoSpecies` as follows:

```{r, eval = FALSE}
newdata <- powoSpecies(family = "Poaceae",
                       genus = c("Andropogon", "Olyra", "Digitaria"),
                       synonyms = TRUE,
                       save = FALSE,
                       dir = "Poaceae_results",
                       filename = "Poaceae_spp")
```

Then, we used the newly developed function `accGraph` to plot individual graphs of 
accumulation of species discovery and a violin graph for the three genera. 

```{r, eval = FALSE}
accGraph(inputdf = newdata,
         verbose = TRUE,
         multi = TRUE,
         save = TRUE,
         dir = "results_accGraph",
         filename = "cumulative_discovery_Poaceae_",
         format = "jpg")
```
\
```{r, echo = FALSE, out.width = "600px", fig.cap = "FIGURE 2. Accumulation graph of new species discoveries in the genus _Andropogon_ over time."}
knitr::include_graphics("figures/cumulative_discovery_Poaceae_Andropogon.png", 
                        dpi = 300)
```
\
```{r, echo = FALSE, out.width = "600px", fig.cap = "FIGURE 3. Accumulation graph of new species discoveries in the genus _Digitaria_ over time."}
knitr::include_graphics("figures/cumulative_discovery_Poaceae_Digitaria.png", 
                        dpi = 300)
```
\
```{r, echo = FALSE, out.width = "600px", fig.cap = "FIGURE 4. Accumulation graph of new species discoveries in the genus _Olyra_ over time."}
knitr::include_graphics("figures/cumulative_discovery_Poaceae_Olyra.png", 
                        dpi = 300)
```
\
```{r, echo = FALSE, out.width = "600px", fig.cap = "FIGURE 5. Violin graph of new species discoveries in three genera over time."}
knitr::include_graphics("figures/cumulative_discovery_Poaceae_all_data.png", 
                        dpi = 300)
```
\

Each one of the individual accumulation graphs showed different patterns, and while _Andropogon_ and _Digitaria_ showed similar rates of new discoveries and taxonomic changes, any of the accepted 25 spp. of _Olyra_ went through a correction in the year of publication. Additionally, the violin plot (Fig. 5) showed a peak of synonymizations of _Andropogon_ around 1870, and a peak of accepted names of _Digitaria_ being published around 1925.
\

